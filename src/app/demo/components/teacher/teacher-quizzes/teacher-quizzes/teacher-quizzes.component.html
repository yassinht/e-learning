<div class="grid">
    <div class="col-12">
      <div class="card px-6 py-6">
        <p-toolbar styleClass="mb-4">
          <ng-template pTemplate="left">
            <div class="my-2">
              <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success mr-2" (click)="openNew()"></button>
              <button pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-danger" (click)="deleteSelectedCourses()" [disabled]="!selectedQuiz"></button>
            </div>
          </ng-template>
          <ng-template pTemplate="right"></ng-template>
        </p-toolbar>
  
        <p-table [value]="quizzes" [columns]="cols" responsiveLayout="scroll" [globalFilterFields]="['title','description','formations']"
          [paginator]="true" [rows]="10" [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [(selection)]="selectedQuiz" selectionMode="single" [rowHover]="true" dataKey="_id">
          <ng-template pTemplate="caption">
            <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
              <h5 class="m-0">Manage Quizzes</h5>
              <span class="block mt-2 md:mt-0 p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text" (input)="onGlobalFilter($event)" placeholder="Search..." class="w-full sm:w-auto" />
              </span>
            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 3rem">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
              </th>
              <th pSortableColumn="title">Title <p-sortIcon field="title"></p-sortIcon></th>
              <th pSortableColumn="description">Description <p-sortIcon field="description"></p-sortIcon></th>
              <th pSortableColumn="formations">Formations <p-sortIcon field="formations"></p-sortIcon></th>
              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-quiz>
            <tr>
              <td>
                <p-tableCheckbox [value]="quiz" aria-disabled="true"></p-tableCheckbox>
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Title</span>
                {{ quiz.title }}
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Description</span>
                {{ quiz.description }}
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Formations</span>
                <ul>
                  <li *ngFor="let formation of quiz.formations">
                    {{ formation.name }} - {{ formation.description }}
                  </li>
                </ul>
              </td>
              <td>
                <div class="flex">
                  <button pButton pRipple icon="pi pi-info-circle" class="p-button-rounded p-button-info mr-2"
                    (click)="onSelectQuiz(quiz)">View Questions</button>
                  <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success mr-2"
                    (click)="editQuiz(quiz)"></button>
                  <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning" (click)="deleteQuiz(quiz)"></button>
                </div>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
  <div class="grid">
    <div class="col-12">
      <div class="card px-6 py-6">
        <p-toolbar styleClass="mb-4">
          <ng-template pTemplate="left">
            <div class="my-2">
              <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success mr-2" (click)="openNew()"></button>
              <button pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-danger" (click)="deleteSelectedCourses()" [disabled]="!selectedQuiz"></button>
            </div>
          </ng-template>
          <ng-template pTemplate="right"></ng-template>
        </p-toolbar>
  
        <p-table [value]="quizzes" [columns]="cols" responsiveLayout="scroll" [globalFilterFields]="['title','description','formations']"
          [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [(selection)]="selectedQuiz"
          selectionMode="single" [rowHover]="true" dataKey="_id">
          <ng-template pTemplate="caption">
            <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
              <h5 class="m-0">Manage Quizzes</h5>
              <span class="block mt-2 md:mt-0 p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text" (input)="onGlobalFilter($event)" placeholder="Search..." class="w-full sm:w-auto" />
              </span>
            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 3rem">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
              </th>
              <th pSortableColumn="title">Title <p-sortIcon field="title"></p-sortIcon></th>
              <th pSortableColumn="description">Description <p-sortIcon field="description"></p-sortIcon></th>
              <th pSortableColumn="formations">Formations <p-sortIcon field="formations"></p-sortIcon></th>
              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-quiz>
            <tr>
              <td>
                <p-tableCheckbox [value]="quiz"></p-tableCheckbox>
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Title</span>
                {{ quiz.title }}
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Description</span>
                {{ quiz.description }}
              </td>
              <td style="width: 30%;">
                <span class="p-column-title">Formations</span>
                <ul>
                  <li *ngFor="let formation of quiz.formations">
                    {{ formation.name }} - {{ formation.description }}
                  </li>
                </ul>
              </td>
              <td>
                <div class="flex">
                  <button pButton pRipple icon="pi pi-info-circle" class="p-button-rounded p-button-info mr-2"
                    (click)="onSelectQuiz(quiz)">View Questions</button>
                  <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success mr-2"
                    (click)="editQuiz(quiz)"></button>
                  <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning" (click)="deleteQuiz(quiz)"></button>
                </div>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
  
 <!-- Quiz Details Dialog -->
<p-dialog *ngIf="selectedQuiz" [(visible)]="quizDialog" [style]="{width: '650px'}" header="Quiz Details" [modal]="true" class="p-fluid">
    <ng-template pTemplate="content">
      <div class="p-field">
        <label for="title">Title</label>
        <input type="text" pInputText id="title" [(ngModel)]="selectedQuiz.title" readonly />
      </div>
      <div class="p-field">
        <label for="description">Description</label>
        <input type="text" pInputText id="description" [(ngModel)]="selectedQuiz.description" readonly />
      </div>
      <div class="p-field">
        <label>Questions</label>
        <ol>
          <li *ngFor="let question of selectedQuiz.questions" class="question-item">
            <div class="question-content">
              <p>{{ question.content }}</p>
            </div>
            <ul class="options-list">
              <li *ngFor="let option of question.options" [ngClass]="{'correct-option': option.isCorrect}">
                <span class="p-checkbox">
                  <input type="checkbox" [disabled]="true" [checked]="option.isCorrect" />
                  <label>{{ option.content }}</label>
                </span>
              </li>
            </ul>
          </li>
        </ol>
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <button pButton pRipple label="Close" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
    </ng-template>
  </p-dialog>
  